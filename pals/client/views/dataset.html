<template name="dataset">
  {{#if inCreateMode}}
    {{#autoForm collection="DraftDataSets" id="createDatasetForm" type="normal" validation='blur'}}
      <fieldset>
        <legend>Create New Data Set</legend>
        <div class="alert alert-danger error"></div>
        {{> afQuickField name='name'}}
        {{> afQuickField name='type' type='select' firstOption="(Select One)" options='allowed'}}
        {{> afQuickField name='spatialLevel' type='select' firstOption="(Select One)" options='allowed'}}
        {{> afQuickField name='country' type='select' firstOption="(Select One)" options='allowed'}}
        {{> afQuickField name='vegType' type='select' firstOption="(Select One)" options='allowed'}}
        {{> afQuickField name='soilType'}}
        {{> afQuickField name='url'}}
        {{> afQuickField name='lat'}}
        {{> afQuickField name='lon'}}
        {{> afQuickField name='elevation'}}
        {{> afQuickField name='maxVegHeight'}}
        {{> afQuickField name='utcOffset'}}
        {{> afQuickField name='siteContact'}}
        {{> afQuickField name='references' rows=6}}
        {{> afQuickField name='comments' rows=6}}
        <b>Variables</b>
        {{> afQuickField name='variables.NEE' type='boolean-checkbox'}}
        {{> afQuickField name='variables.Qg' type='boolean-checkbox'}}
        {{> afQuickField name='variables.Qh' type='boolean-checkbox'}}
        {{> afQuickField name='variables.Qle' type='boolean-checkbox'}}
        {{> afQuickField name='variables.Rnet' type='boolean-checkbox'}}
        {{> afQuickField name='variables.SWnet' type='boolean-checkbox'}}
        {{> afQuickField name='region'}}
        {{> afQuickField name='resolution' type='select' firstOption="(Select One)" options='allowed'}}
        <div class="col-md-6">
          <div class="panel panel-primary">
            <div class="panel-heading">Files</div>
            {{#if draftHasFiles}}
              <table class="table table-hover">
                  <thead>
                  <tr>
                      <th>File</th>
                      {{#if currentUser.admin}}<th>delete</th>{{/if}}
                  </tr>
                  </thead>
                  <tbody>
                  {{#each draftFiles}}
                  <tr>
                      {{#if isPublicOrOwner}}
                      <td onclick="window.location.href='/file/{{key}}/{{encode 'application/x-netcdf'}}'">{{name}}</td>
                      {{else}}
                      <td>{{name}}</td>
                      {{/if}}
                      {{#if inEditMode}}<td><button class='delete-file btn btn-danger btn-xs' id='{{key}}'>delete</button></td>{{/if}}
                  </tr>
                  {{/each}}
                  </tbody>
              </table>
            {{/if}}
            <div class="panel-body">
            {{#if inEditMode}}
                <label>Upload a new file</label>
                <input type="file" class="file-select" name="file-select"/>
                <div class="progress progress-striped active">
                  <div class="progress-bar"  role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"
                      style="width:0%">
                  </div>
                </div>
            {{/if}}
            </div>
          </div>
        </div>
        <div class="col-md-12">
            <button type="submit" class="create-btn btn btn-primary">Save</button>
            <button type="reset" class="create-btn btn btn-primary cancel-create">Cancel</button>
        </div>
      </fieldset>
    {{/autoForm}}
  {{else}}
    {{#if inUpdateMode}}
      {{#autoForm collection="DraftDataSets" doc=dataSet id="updateDatasetForm" type="normal"}}
        <fieldset>
            <div class="alert-danger" align="center"><b>Warning: Currently in Draft Mode.
                <br>Data set won't be updated until "Save New Version" is clicked below.</b></div>
          <h1>Data Set: {{dataSet.name}}</h1>
          <a class="btn btn-success enable-update pull-right" disabled=true>Edit Data Set</a>
          <br>
          {{> afQuickField name='name'}}
          {{> afQuickField name='type' type='select' firstOption="(Select One)" options='allowed'}}
          {{> afQuickField name='spatialLevel' type='select' firstOption="(Select One)" options='allowed'}}
          {{> afQuickField name='country' type='select' firstOption="(Select One)" options='allowed'}}
          {{> afQuickField name='vegType' type='select' firstOption="(Select One)" options='allowed'}}
          {{#if afFieldValueIs name='vegType' value='Other'}}
            {{> afQuickField name='otherVegType'}}
          {{/if}}
          {{> afQuickField name='soilType'}}
          {{> afQuickField name='url'}}
          {{> afQuickField name='lat'}}
          {{> afQuickField name='lon'}}
          {{> afQuickField name='elevation'}}
          {{> afQuickField name='maxVegHeight'}}
          {{> afQuickField name='utcOffset'}}
          {{> afQuickField name='siteContact'}}
          {{> afQuickField name='references' rows=6}}
          {{> afQuickField name='comments' rows=6}}
          <b>Variables</b>
          {{> afQuickField name='variables.NEE' type='boolean-checkbox'}}
          {{> afQuickField name='variables.Qg' type='boolean-checkbox'}}
          {{> afQuickField name='variables.Qh' type='boolean-checkbox'}}
          {{> afQuickField name='variables.Qle' type='boolean-checkbox'}}
          {{> afQuickField name='variables.Rnet' type='boolean-checkbox'}}
          {{> afQuickField name='variables.SWnet' type='boolean-checkbox'}}
          {{> afQuickField name='region'}}
          {{> afQuickField name='resolution' type='select' firstOption="(Select One)" options='allowed'}}
          <div class="col-md-6">
            <div class="panel panel-primary">
              <div class="panel-heading">Files</div>
              {{#if draftHasFiles}}
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th>File</th>
                        {{#if currentUser.admin}}<th>delete</th>{{/if}}
                    </tr>
                    </thead>
                    <tbody>
                    {{#each draftFiles}}
                    <tr>
                        {{#if isPublicOrOwner}}
                        <td onclick="window.location.href='/file/{{key}}/{{encode 'application/x-netcdf'}}'">{{name}}</td>
                        {{else}}
                        <td>{{name}}</td>
                        {{/if}}
                        {{#if inEditMode}}<td><button class='delete-file btn btn-danger btn-xs' id='{{key}}'>delete</button></td>{{/if}}
                    </tr>
                    {{/each}}
                    </tbody>
                </table>
              {{/if}}
              <div class="panel-body">
              {{#if inEditMode}}
                  <label>Upload a new file</label>
                  <input type="file" class="file-select" name="file-select"/>
                  <div class="progress progress-striped active">
                    <div class="progress-bar"  role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"
                        style="width:0%">
                    </div>
                  </div>
              {{/if}}
              </div>
            </div>
          </div>
        </fieldset>
        <div class="alert-danger" align="center"><b>Warning: Currently in Draft Mode.
            <br>Data set won't be updated until "Save New Version" is clicked below.</b>
        </div>
        <br>
        <a class="btn btn-success enable-update pull-right" disabled=true>Edit Data Set</a>
        <button type="submit" class="btn btn-primary">Save New Version</button>
        <button type="reset" class="cancel-update btn btn-primary">Cancel</button>
      {{/autoForm}}
    {{else}}

      <form role="form">
        <h1>Data Set: {{dataSet.name}}</h1>
        <div class="alert alert-danger error"></div>
        {{#if currentUser.admin}}<a class="btn btn-success enable-update pull-right">Edit Data Set</a>{{/if}}
        <br>
        <div class="form-group">
            <label>Name</label>
            <div class="display">{{dataSet.name}}</div>
        </div>
        <div class="form-group">
            {{#if dataSet.type}}
                <label>Type</label>
                <div class="display">{{dataSet.type}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.spatialLevel}}
                <label>Spatial Resolution</label>
                <div class="display">{{dataSet.spatialLevel}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.country}}
                <label>Country</label>
                <div class="display">{{dataSet.country}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.vegType}}
                <label>IGBP Vegetation Type</label>
                <div class="display">{{dataSet.vegType}}</div>
            {{/if}}
        </div>
        <div class="form-group">
                {{#if dataSet.soilType}}
                    <label>Soil Type</label>
                    <div class="display">{{dataSet.soilType}}</div>
                {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.url}}
                <label>Site Description URL</label>
                <div class="display">{{dataSet.url}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.lat}}
                <label>Latitude (decimal)</label>
                <div class="display">{{dataSet.lat}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.lon}}
                <label>Longitude (decimal)</label>
                <div class="display">{{dataSet.lon}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.elevation}}
                <label>Elevation (m)</label>
                <div class="display">{{dataSet.elevation}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.maxVegHeight}}
                <label>Max Vegetation Height (m)</label>
                <div class="display">{{dataSet.maxVegHeight}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.utcOffset}}
                <label>UTC Offset (hours)</label>
                <div class="display">{{dataSet.utcOffset}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.siteContact}}
                <label>Site Contact</label>
                <div class="display">{{dataSet.siteContact}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.references}}
                <label>References</label>
                <div class="display">{{{breaklines dataSet.references}}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.comments}}
                <label>Comments</label>
                <div class="display">{{{breaklines dataSet.comments}}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            <label>Variables</label>
        </div>
        <div class="form-group">
            {{#if dataSet.region}}
                <label>Region</label>
                <div class="display">{{dataSet.region}}</div>
            {{/if}}
        </div>
        <div class="form-group">
            {{#if dataSet.resolution}}
                <label>Resolution</label>
                <div class="display">{{dataSet.resolution}}</div>
            {{/if}}
        </div>
      </form>
      <div class="col-md-6">
       <div class="panel panel-primary">
         <div class="panel-heading">Files</div>
         {{#if hasFiles}}
         <table class="table table-hover">
             <thead>
             <tr>
                 <th>File</th>
             </tr>
             </thead>
             <tbody>
             {{#each files}}
             <tr>
                 {{#if isPublicOrOwner}}
                 <td onclick="window.location.href='/file/{{key}}/{{encode 'application/x-netcdf'}}'">{{name}}</td>
                 {{else}}
                 <td>{{name}}</td>
                 {{/if}}
             </tr>
             {{/each}}
             </tbody>
         </table>
         {{/if}}
         <div class="panel-body">
         </div>
       </div>
      </div>
        {{#if currentUser.admin}}
            <div class="col-md-12">
                <a class="btn btn-success enable-update pull-right">Edit Data Set</a>
            </div>
        {{/if}}
    {{/if}}
  {{/if}}
</template>

<!--
<template name="dataset">
  <div class="row">
    <div class="col-md-8">
      <form role="form">
        <h1>Data Set: {{dataSet.name}}</h1>
        <div class="alert alert-danger error"></div>
        {{#if inDisplayMode}}{{#if currentUser.admin}}{{#if latestVersion}}<a class="btn btn-success enable-update pull-right" disabled={{updateBtnDisabled}}>Update Data Set</a>{{/if}}{{/if}}{{/if}}
        <br>
   <div class="form-group">
       <label>Data Set Name</label>
       {{#if inEditMode}}
          <input class="modifier form-control" type="text" value="{{cloneDataSet.name}}">
       {{else}}
           <div class="display">{{dataSet.name}}</div>
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
       <label>Data Set Type</label>
       <select class="form-control trigger">
           <option value="n/a"></option>
           {{#each reference.dataSetType}}
           <option value='{{this}}' {{selected this cloneDataSet.type}}>{{this}}</option>
           {{/each}}
       </select>
       {{else}}
       {{#if dataSet.type}}
           <label>Data Set Type</label>
           <div class="display">{{dataSet.type}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
       <label>Spatial Level</label>
       <select class="form-control trigger">
           {{#each reference.spatialLevel}}
           <option value='{{this}}' {{selected this cloneDataSet.spatialLevel}}>{{this}}</option>
           {{/each}}
       </select>
       {{else}}
       {{#if dataSet.spatialLevel}}
           <label>Spatial Resolution</label>
           <div class="display">{{dataSet.spatialLevel}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
       <label>Country</label>
       <select class="form-control trigger">
           <option value="n/a"></option>
           {{#each reference.country}}
           <option value='{{this}}' {{selected this cloneDataSet.country}}>{{this}}</option>
           {{/each}}
       </select>
       {{else}}
       {{#if dataSet.country}}
           <label>Country</label>
           <div class="display">{{dataSet.country}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
       <label>IGBP Vegetation Type</label>
       <select class="form-control trigger">
           <option value="n/a"></option>
           {{#each reference.vegType}}
           <option value='{{this}}' {{selected this cloneDataSet.vegType}}>{{this}}</option>
           {{/each}}
       </select>
       {{else}}
       {{#if dataSet.vegType}}
           <label>IGBP Vegetation Type</label>
           <div class="display">{{dataSet.vegType}}</div>
       {{/if}}
       {{/if}}
   </div>
   {{#if inEditMode}}
   <div class="form-group">
       <label>or enter a different Vegetation Type</label>
       <input class="modifier form-control" type="text" value="{{#if cloneDataSet.vegType}}{{cloneDataSet.vegType}}{{/if}}">
   </div>
   {{/if}}
   <div class="form-group">
       {{#if inEditMode}}
           <label>Soil Type</label>
           <input class="modifier form-control" type="text" value="{{cloneDataSet.soilType}}">
       {{else}}
           {{#if dataSet.soilType}}
               <label>Soil Type</label>
               <div class="display">{{dataSet.soilType}}</div>
           {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
           <label>Site Description URL</label>
           <input class="modifier form-control" type="url" value="{{cloneDataSet.url}}">
       {{else}}
       {{#if dataSet.url}}
           <label>Site Description URL</label>
           <div class="display">{{dataSet.url}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
           <label>Latitude (decimal)</label>
           <input class="modifier form-control" type="text" value="{{cloneDataSet.lat}}">
       {{else}}
       {{#if dataSet.lat}}
           <label>Latitude (decimal)</label>
           <div class="display">{{dataSet.lat}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
           <label>Longitude (decimal)</label>
           <input class="modifier form-control" type="text" value="{{cloneDataSet.lon}}">
       {{else}}
       {{#if dataSet.lon}}
           <label>Longitude (decimal)</label>
           <div class="display">{{dataSet.lon}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
           <label>Elevation (m)</label>
           <input class="modifier form-control" type="text" value="{{cloneDataSet.elevation}}">
       {{else}}
       {{#if dataSet.elevation}}
           <label>Elevation (m)</label>
           <div class="display">{{dataSet.elevation}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
          <label>Max Vegetation Height (m)</label>
          <input class="modifier form-control" type="text" value="{{cloneDataSet.maxVegHeight}}">
       {{else}}
       {{#if dataSet.maxVegHeight}}
           <label>Max Vegetation Height (m)</label>
           <div class="display">{{dataSet.maxVegHeight}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
           <label>UTC Offset (hours)</label>
           <input class="modifier form-control" type="text" value="{{cloneDataSet.utcOffset}}">
       {{else}}
       {{#if dataSet.utcOffset}}
           <label>UTC Offset (hours)</label>
           <div class="display">{{dataSet.utcOffset}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
           <label>Site Contact</label>
           <input class="modifier form-control" type="text" value="{{cloneDataSet.siteContact}}">
       {{else}}
       {{#if dataSet.siteContact}}
           <label>Site Contact</label>
           <div class="display">{{dataSet.siteContact}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
           <label>References</label>
           <textarea class="modifier form-control" type="text" >{{cloneDataSet.references}}</textarea>
       {{else}}
       {{#if dataSet.references}}
           <label>References</label>
           <div class="display">{{{breaklines dataSet.references}}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
           <label>Comments</label>
           <textarea class="modifier form-control" type="text" >{{cloneDataSet.comments}}</textarea>
       {{else}}
       {{#if dataSet.comments}}
           <label>Comments</label>
           <div class="display">{{{breaklines dataSet.comments}}}</div>
       {{/if}}
       {{/if}}
   </div>
   {{#if inEditMode}}
   <div class="form-group">
           <label>Variables</label>

           <select class="form-control">
               {{#each variables}}
                   <option value='{{this._id}}'>{{this.name}}</option>
               {{/each}}
           </select>
   </div>
   <a class="btn btn-success add-variable">Add Variable</a>
   <h3>
   {{#each cloneDataSet.variables}}
       <span class="label label-danger">{{this.name}} <a class="delete-button remove-variable" title="remove" id="{{this._id}}"><i class="fa fa-times-circle-o"></i></a></span>
   {{/each}}
   </h3>
   {{else}}
       <label>Variables</label>
       <h4>
       {{#each cloneDataSet.variables}}
           <span class="label label-danger">{{this.name}}</span>
       {{/each}}
       </h4>
   {{/if}}
   <div class="form-group">
       {{#if inEditMode}}
           <label>Region</label>
           <input class="modifier form-control" type="text" value="{{cloneDataSet.region}}">
       {{else}}
       {{#if dataSet.region}}
           <label>Region</label>
           <div class="display">{{dataSet.region}}</div>
       {{/if}}
       {{/if}}
   </div>
   <div class="form-group">
       {{#if inEditMode}}
       <label>Resolution</label>

       <select class="form-control trigger">
           <option value="n/a"></option>
           {{#each reference.resolution}}
           <option value='{{this}}' {{selected this cloneDataSet.resolution}}>{{this}}</option>
           {{/each}}
       </select>
       {{else}}
       {{#if dataSet.resolution}}
           <label>Resolution</label>
           <div class="display">{{dataSet.resolution}}</div>
       {{/if}}
       {{/if}}
   </div>
   {{#if inEditMode}}
   <div class="checkbox">
       <label>
         <input type="checkbox" name="public" {{isPublic}}> Make this Data Set public
       </label>
   </div>
   {{/if}}
</form>
</div>
<div class="col-md-6">
  <div class="panel panel-primary">
    <div class="panel-heading">Files</div>
    {{#if hasFiles}}
    <table class="table table-hover">
        <thead>
        <tr>
            <th>File</th>
            {{#if currentUser.admin}}<th>delete</th>{{/if}}
        </tr>
        </thead>
        <tbody>
        {{#each files}}
        <tr>
            {{#if isPublicOrOwner}}
            <td onclick="window.location.href='/file/{{key}}/{{encode 'application/x-netcdf'}}'">{{name}}</td>
            {{else}}
            <td>{{name}}</td>
            {{/if}}
            {{#if inEditMode}}<td><button class='delete-file btn btn-danger btn-xs' id='{{key}}'>delete</button></td>{{/if}}
        </tr>
        {{/each}}
        </tbody>
    </table>
    {{/if}}
    <div class="panel-body">
    {{#if inEditMode}}
        <label>Upload a new file</label>
        <input type="file" class="file-select" name="file-select"/>
        <div class="progress progress-striped active">
          <div class="progress-bar"  role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"
              style="width:0%">
          </div>
        </div>
    {{/if}}
    </div>
  </div>
  {{#if inEditMode}}
    <a class="btn btn-success save-update">Save As New Version</a>
    <a class="btn btn-default cancel-update">Cancel</a>
  {{/if}}
</div>
</div>
</template>
-->
